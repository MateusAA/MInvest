@model Liberta.UI.Model.CadastroTitulos


@{
    ViewBag.IdUsuario = true;
    Layout = "~/Views/Shared/_Layout.cshtml";
}




@*@{
        // Simulando uma lista de opções de categorias (pode vir de uma fonte de dados real em seu projeto)
        List<SelectListItem> Tipos = new List<SelectListItem>
                     {
                            new SelectListItem { Value = "Renda Fixa", Text = "Renda Fixa" },
                            new SelectListItem { Value = "Ações", Text = "Ações" },
                            new SelectListItem { Value = "Tesouro Direto", Text = "Tesouro Direto" },
                            new SelectListItem { Value = "Fundos Imobiliarios", Text = "Fundos Imobiliarios" }
                            };
    }
    @{
        // Simulando uma lista de opções de categorias (pode vir de uma fonte de dados real em seu projeto)
        List<SelectListItem> Modulos = new List<SelectListItem>
                     {
                            new SelectListItem { Value = "Modulo 1", Text = "Modulo 1" },
                            new SelectListItem { Value = "Modulo 2", Text = "Modulo 2" },
                            new SelectListItem { Value = "Modulo 3", Text = "Modulo 3" },
                            new SelectListItem { Value = "Modulo 4", Text = "Modulo 4" }
                            };
    }*@


@*<link href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />*@



<div class="container mt-5" style="background-color: #EAEDED; border: 2px solid transparent; border-radius: 10px;">
    <div class="row" style="display: flex; align-items: flex-start; ">
        <!--Espaço do lado esquerdo-->
        <div class="col-sm-1">

        </div>
        <div class="col-sm-10">

            <br />
            <br />
            <h2 class="fontLi">Cadastro</h2>
            <br />

            @using (Html.BeginForm("ActionName", "ControllerName", FormMethod.Post, new { id = "formTitulos", @class = "was-validated" }))
            {

                <fieldset class="form-jagged">
                    @Html.HiddenFor(x => x.Id, Model.Id)
                    <div class="form-group row">
                        <div class="col-4">
                            <label class="fontLi2">Nome Titulo:</label>
                        </div>
                        <div class="col-6">
                            @Html.TextBoxFor(m => m.Nome, new { @class = "form-control", @required = "required" })
                            @Html.ValidationMessageFor(m => m.Nome, "", new { @class = "text-danger" })
                            
                        </div>
                    </div>
                    <br />
                    <div class="form-group row">
                        <div class="col-4">
                            <label class="fontLi2">Rentabilidade (%):</label>
                        </div>
                        <div class="col-6">
                            @Html.TextBoxFor(m => m.PercentualRentabilidade, new { @class = "form-control numero", @required = "required" })
                            @Html.ValidationMessageFor(m => m.PercentualRentabilidade, "", new { @class = "text-danger" })
                            
                        </div>
                    </div>
                    <br />
                    <div class="form-group row">
                        <div class="col-4">
                            <label class="fontLi2">Investimento Mínimo:</label>
                        </div>
                        <div class="col-6">
                            @Html.TextBoxFor(m => m.ValorInvestimentoMinimo, new { @class = "form-control dinheiro", @required = "required" })
                            @Html.ValidationMessageFor(m => m.ValorInvestimentoMinimo, "", new { @class = "text-danger" })
                           
                        </div>
                    </div>
                    <br />
                    <div class="form-group row">
                        <div class="col-4">
                            <label class="fontLi2">Dias para Resgate:</label>
                        </div>
                        <div class="col-6">
                            @Html.TextBoxFor(m => m.DiasResgate, new { @class = "form-control numero", @required = "required" })
                            @Html.ValidationMessageFor(m => m.DiasResgate, "", new { @class = "text-danger" })
                            
                        </div>
                    </div>
                    <br />
                    <div class="form-group row">
                        <div class="col-4">
                            <label class="fontLi2">Vencimento:</label>
                        </div>
                        <div class="col-6">
                            @Html.TextBoxFor(m => m.DataVencimento, new { @class = "form-control data", @required = "required" })
                            @Html.ValidationMessageFor(m => m.DataVencimento, "", new { @class = "text-danger" })
                            
                        </div>
                    </div>
                    <br />
                    <div class="form-group row">
                        <div class="col-4">
                            <label class="fontLi2">IR - Imposto de Renda (%)</label>
                        </div>
                        <div class="col-6">
                            @Html.TextBoxFor(m => m.PercentualIR, new { @class = "form-control numero", @required = "required" })
                            @Html.ValidationMessageFor(m => m.PercentualIR, "", new { @class = "text-danger" })
                            
                        </div>
                    </div>
                    <br />
                    <div class="form-group row">
                        <div class="col-4">
                            <label class="fontLi2">IOF - Imposto sobre Operações Financeiras (%)</label>
                        </div>
                        <div class="col-6">
                            @Html.TextBoxFor(m => m.PercentualIOF, new { @class = "form-control numero", @required = "required" })
                            @Html.ValidationMessageFor(m => m.PercentualIOF, "", new { @class = "text-danger" })
                            
                        </div>
                    </div>
                    <br />
                    <div class="form-group row">
                        <div class="col-4">
                            <label class="fontLi2">Tipo de Investimento:</label>
                        </div>
                        <div class="col-6">
                            @Html.DropDownListFor(m => m.TipoAtivo, Model.ddlTipoAtivo, new { @class = "form-control", @required = "required" })
                            @Html.ValidationMessageFor(m => m.ddlTipoAtivo, "", new { @class = "text-danger" })
                            
                        </div>
                    </div>
                    <br />
                    <div class="form-group row">
                        <div class="col-4">
                            <label class="fontLi2">Tipo de Titulo:</label>
                        </div>
                        <div class="col-6">
                            @Html.DropDownListFor(m => m.TipoTitulo, Model.ddlTipoTitulo, new { @class = "form-control", @required = "required" })
                            @Html.ValidationMessageFor(m => m.ddlTipoTitulo, "", new { @class = "text-danger" })
                            
                        </div>
                    </div>
                    <br />
                    <div class="form-group row">
                        <div class="col-4">
                            <label class="fontLi2">Modulo de Investimento:</label>
                        </div>
                        <div class="col-6">
                            @Html.DropDownListFor(m => m.Modulo, Model.ddlModulos, new { @class = "form-control", @required = "required" })
                            @Html.ValidationMessageFor(m => m.ddlModulos, "", new { @class = "text-danger" })
                            
                        </div>
                    </div>

                    <br />
                    <button id="btnGravar" type="submit" class="btn" style="background-color: #5CBB61;">Registrar</button>
                </fieldset>
            }
        </div>
    </div>
    <center>
        <div class="row" style="width: 90%; ">
            @Html.Partial("_GridTitulos", Model.listaGrid)
        </div>
    </center>
</div>
<br />
<br />

@section Styles {
    <link href="@Styles.Url("~/Vendor/bootstrap-tagsinput/dist/bootstrap-tagsinput.css")" rel="stylesheet" />
    <link href="@Styles.Url("~/Vendor/bootstrap-slider/dist/css/bootstrap-slider.css")" rel="stylesheet" />
    <link href="@Styles.Url("~/Vendor/chosen-js/chosen.css")" rel="stylesheet" />
    <link href="@Styles.Url("~/Vendor/bootstrap-datepicker/dist/css/bootstrap-datepicker.css")" rel="stylesheet" />
    <link href="@Styles.Url("~/Vendor/bootstrap-colorpicker/dist/css/bootstrap-colorpicker.css")" rel="stylesheet" />
    <link href="@Styles.Url("~/Vendor/select2/dist/css/select2.css")" rel="stylesheet" />
    <link href="@Styles.Url("~/Vendor/@ttskch/select2-bootstrap4-theme/dist/select2-bootstrap4.css")" rel="stylesheet" />
    <link href="@Styles.Url("~/Vendor/components-jqueryui/themes/smoothness/jquery-ui.css")" rel="stylesheet" />

}
@section Scripts {
    <script src="@Scripts.Url("~/Vendor/bootstrap-filestyle/src/bootstrap-filestyle.js")"></script>
    <script src="@Scripts.Url("~/Vendor/bootstrap-tagsinput/dist/bootstrap-tagsinput.js")"></script>
    <script src="@Scripts.Url("~/Vendor/chosen-js/chosen.jquery.js")"></script>
    <script src="@Scripts.Url("~/Vendor/bootstrap-slider/dist/bootstrap-slider.js")"></script>
    <script src="@Scripts.Url("~/Vendor/inputmask/dist/jquery.inputmask.bundle.js")"></script>
    <script src="@Scripts.Url("~/Vendor/bootstrap-wysiwyg/js/bootstrap-wysiwyg.min.js")"></script>
    <script src="@Scripts.Url("~/Vendor/moment/min/moment-with-locales.js")"></script>
    <script src="@Scripts.Url("~/Vendor/bootstrap-datepicker/dist/js/bootstrap-datepicker.js")"></script>
    <script src="@Scripts.Url("~/Vendor/bootstrap-colorpicker/dist/js/bootstrap-colorpicker.js")"></script>
    <script src="@Scripts.Url("~/Vendor/select2/dist/js/select2.full.js")"></script>
    <script src="@Scripts.Url("~/Vendor/sweetalert/dist/sweetalert.min.js")"></script>
    <script src="@Scripts.Url("~/Vendor/parsleyjs/dist/parsley.js")"></script>
    <script src="@Scripts.Url("~/Vendor/jquery-validation/dist/jquery.validate.js")"></script>
    <script src="@Scripts.Url("~/Vendor/components-jqueryui/jquery-ui.js")"></script>
    }

    @Scripts.Render("~/bundles/jqueryval")

<script type="text/javascript">
    "use strict";
    $(document).ready(function () {
        AplicarMascaras();

    });


    $("#TipoAtivo").change(function () {

        var tipoRenda = $(this).val()

        $.ajax({
            cache: false,
            url: '@Url.Action("CarregarTipos", "CadastroTitulos")',
            type: 'POST',
            data: { tipoRenda: tipoRenda },
            success: function (data) {
                debugger;
                $.each(data, function (i, data) {
                    debugger
                    $("#TipoTitulo").append('<option value="' + data.Value + '">' + data.Text + '</option>');
                });
            }, error: function (jqXHR, txtStatus, errorThrown) {
                alert("Erro");
            }

        });
    });

    @*$("#btnGravar").click(function (e) {

        e.preventDefault();
        debugger;

        $.ajax({
            cache: false,
            url: '@Url.Action("Gravar", "CadastroTitulos")',
            type: 'POST',
            data: $("#formTitulos").serialize(),
            success: function (data) {
                alert(data);
                $("#TipoTitulo").html(data);
                $("#formTitulos")[0].reset();
            }, error: function (jqXHR, txtStatus, errorThrown) {
                swal("Erro!", errorThrown, "error");
            }

        });

    });*@
        $('form[id="formTitulos"]').validate({
            rules: {
                Nome: 'required',
                PercentualRentabilidade: 'required',
                ValorInvestimentoMinimo: 'required',
                DiasResgate: 'required',
                DataVencimento: 'required',
                PercentualIR: 'required',
                PercentualIOF: 'required',
                TipoAtivo: 'required',
                TipoTitulo: 'required',
                Modulo: 'required',


            },
            errorElement: 'div',
            errorPlacement: function (error, element) {

            },
            submitHandler: function (form) {


                $.ajax({
                    cache: false,
                    url: '@Url.Action("Gravar", "CadastroTitulos")',
                    type: 'POST',
                    data: $("#formTitulos").serialize(),
                    success: function (data) {
                        $("#TipoTitulo").html(data);
                        swal("Sucesso!", "Titulo inserido com sucesso.", "success")
                        $("#formTitulos")[0].reset();
                        location.reload();
                    }, error: function (jqXHR, txtStatus, errorThrown) {
                        swal("Erro!", errorThrown, "error");
                    }

                });
             }
        });
    

</script>





